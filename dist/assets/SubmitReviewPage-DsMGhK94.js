import{j as e,a as L,T as Y,b as G,c as U}from"./index-BFi3ExnV.js";import{u as B,r as i}from"./react-vendor-DAZAlSq7.js";import{P as Q}from"./ProgressBar-D5jOSA2y.js";import{B as V,b as J,P as K,j as X,m as $,n as F,o as Z,E as ee}from"./icons-CXffLe3G.js";import"./supabase-C47zntBf.js";const R=({title:o,description:n,children:b,required:c=!1})=>e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200 mb-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 flex items-center",children:[o,c&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),n&&e.jsx("p",{className:"text-gray-600 mt-2 leading-relaxed",children:n})]}),b]}),se=({selectedCompany:o,onCompanySelect:n,placeholder:b="Search for your company..."})=>{const c=B(),[h,l]=i.useState(!1),[d,p]=i.useState(""),[j,g]=i.useState([]),[m,N]=i.useState(!1),a=i.useRef(null);i.useEffect(()=>{const v=setTimeout(async()=>{if(d.trim()){N(!0);try{const w=await L(d);g(w)}catch(w){console.error("Error searching companies:",w),g([])}finally{N(!1)}}else g([])},300);return()=>clearTimeout(v)},[d]),i.useEffect(()=>{h?(async()=>{if(h&&!d&&j.length===0){N(!0);try{const v=await L("");g(v.slice(0,5))}catch(v){console.error("Error loading companies:",v),g([{id:"1",name:"Google",industry:"Technology",size:"10000+"},{id:"2",name:"Apple",industry:"Technology",size:"10000+"},{id:"3",name:"Microsoft",industry:"Technology",size:"10000+"},{id:"4",name:"Amazon",industry:"E-commerce",size:"10000+"},{id:"5",name:"Meta",industry:"Technology",size:"10000+"}])}finally{N(!1)}}})():g([])},[h]),i.useEffect(()=>{const u=v=>{a.current&&!a.current.contains(v.target)&&l(!1)};return document.addEventListener("mousedown",u),()=>document.removeEventListener("mousedown",u)},[]);const f=u=>{n(u),p(""),l(!1)},C=u=>{p(u.target.value),l(!0)};return e.jsxs("div",{className:"relative",ref:a,children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(V,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",value:o?o.name:d,onChange:C,onFocus:()=>l(!0),placeholder:b,className:"w-full pl-10 pr-10 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"}),e.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:e.jsx(J,{className:`h-5 w-5 text-gray-400 transition-transform duration-200 ${h?"rotate-180":""}`})})]}),h&&e.jsxs("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:[m?e.jsxs("div",{className:"px-4 py-3 text-gray-500 text-center",children:[e.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-blue-500 border-t-transparent rounded-full mx-auto mb-2"}),e.jsx("p",{children:"Searching companies..."})]}):j.length>0?j.map(u=>e.jsx("button",{onClick:()=>f(u),className:"w-full px-4 py-3 text-left hover:bg-gray-50 focus:bg-gray-50 focus:outline-none transition-colors duration-200 border-b border-gray-100 last:border-b-0",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:u.name}),e.jsx("p",{className:"text-sm text-gray-500",children:u.industry})]})})},u.id)):e.jsxs("div",{className:"px-4 py-3 text-gray-500 text-center",children:[e.jsx("p",{children:d?"No companies found":"Start typing to search companies"}),d&&e.jsx("p",{className:"text-sm mt-1",children:"Try a different search term"})]}),e.jsx("div",{className:"border-t border-gray-200 bg-gray-50",children:e.jsxs("button",{onClick:()=>c("/request-company",{state:{fromReview:!0,suggestedName:d}}),className:"w-full px-4 py-3 text-left hover:bg-gray-100 focus:bg-gray-100 focus:outline-none transition-colors duration-200 flex items-center justify-center space-x-2 text-blue-600 font-medium",children:[e.jsx(K,{className:"w-4 h-4"}),e.jsx("span",{children:"Company not listed? Request to add it"})]})})]})]})},I=({rating:o,onRatingChange:n,size:b="md",disabled:c=!1})=>{const[h,l]=i.useState(0),d={sm:"w-4 h-4",md:"w-5 h-5",lg:"w-6 h-6"},p=m=>{c||n(m)},j=m=>{c||l(m)},g=()=>{c||l(0)};return e.jsx("div",{className:"flex items-center space-x-1",children:[1,2,3,4,5].map(m=>{const N=m<=(h||o);return e.jsx("button",{type:"button",onClick:()=>p(m),onMouseEnter:()=>j(m),onMouseLeave:g,disabled:c,className:`transition-all duration-200 ${c?"cursor-not-allowed":"cursor-pointer hover:scale-110"}`,"aria-label":`Rate ${m} stars`,children:e.jsx(X,{className:`${d[b]} transition-colors duration-200 ${N?"text-yellow-400 fill-current":"text-gray-300 hover:text-yellow-200"}`})},m)})})},O=({value:o,onChange:n,placeholder:b,maxLength:c,rows:h=4,label:l,required:d=!1})=>{const p=c-o.length,j=p<=50,g=p<0;return e.jsxs("div",{className:"space-y-2",children:[l&&e.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[l,d&&e.jsx("span",{className:"text-red-500 ml-1",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("textarea",{value:o,onChange:m=>n(m.target.value),placeholder:b,rows:h,className:`w-full px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 resize-none ${g?"border-red-300 focus:ring-red-500":"border-gray-300"}`}),e.jsxs("div",{className:`absolute bottom-2 right-2 text-xs px-2 py-1 rounded ${g?"text-red-600 bg-red-50":j?"text-orange-600 bg-orange-50":"text-gray-500 bg-gray-50"}`,children:[p," chars left"]})]})]})},le=()=>{var E;const o=B(),n=i.useContext(Y),[b,c]=i.useState(!1),[h,l]=i.useState(!1),[d,p]=i.useState(!1),[j,g]=i.useState(null),[m,N]=i.useState(!0),[a,f]=i.useState({company:null,industry:"",companySize:"",role:"",ratings:[{id:"compensation",title:"Compensation & Benefits",description:"Salary, bonuses, health insurance, and perks.",rating:0,feedback:""},{id:"management",title:"Management Quality",description:"Executive Leadership effectiveness and overall business strategy.",rating:0,feedback:""},{id:"culture",title:"Culture, Values & Inclusion",description:"Company values, diversity, and inclusive environment",rating:0,feedback:""},{id:"career",title:"Career Opportunities & Development",description:"Growth potential, learning, and skill development.",rating:0,feedback:""},{id:"recognition",title:"Recognition & Appreciation",description:"How well your work and contributions are acknowledged.",rating:0,feedback:""},{id:"environment",title:"Working Environment",description:"Office/remote setup, tools provided, and general workspace quality.",rating:0,feedback:""},{id:"worklife",title:"Work-Life Balance",description:"Flexible hours, vacation policy, stress levels, and respect for personal time.",rating:0,feedback:""},{id:"cooperation",title:"Cooperation & Relationships",description:"Quality of teamwork, communication, and colleague relationships.",rating:0,feedback:""},{id:"business_health",title:"Business Health & Outlook",description:"Financial stability, long-term viability, and job security.",rating:0,feedback:""}],overallRecommendation:"",friendAdvice:""});i.useEffect(()=>{(async()=>{try{const t=await G();if(!t){o("/",{state:{message:"Please verify your email to submit a review."}});return}g(t)}catch(t){console.error("Auth check failed:",t),o("/")}finally{N(!1)}})()},[o]);const C=()=>{let s=0;const t=13;return a.company&&s++,a.role.trim()&&s++,a.ratings.forEach(x=>{x.rating>0&&s++}),a.overallRecommendation&&s++,a.friendAdvice.trim()&&s++,s/t*100};i.useEffect(()=>{const s=setTimeout(()=>{(a.company||a.ratings.some(t=>t.rating>0))&&u()},2e3);return()=>clearTimeout(s)},[a]);const u=async()=>{p(!0),await new Promise(s=>setTimeout(s,500)),p(!1)},v=s=>{f(t=>({...t,company:s,industry:s.industry,companySize:s.size}))},w=(s,t)=>{f(x=>({...x,ratings:x.ratings.map(y=>y.id===s?{...y,rating:t}:y)}))},H=(s,t)=>{f(x=>({...x,ratings:x.ratings.map(y=>y.id===s?{...y,feedback:t}:y)}))},q=async()=>{var s,t,x,y,T,A,z,P,M;l(!0);try{if(!a.company){n==null||n.error("Please select a company"),l(!1);return}if(!a.role.trim()){n==null||n.error("Please enter your role or department"),l(!1);return}if(!a.overallRecommendation){n==null||n.error("Please provide your overall recommendation"),l(!1);return}const k={company_id:a.company.id,overall_rating:Math.round(a.ratings.reduce((r,_)=>r+_.rating,0)/a.ratings.length),recommendation:a.overallRecommendation,role:a.role.trim(),pros:a.ratings.filter(r=>r.feedback.trim()&&r.rating>=4).map(r=>r.feedback.trim()).slice(0,3),cons:a.ratings.filter(r=>r.feedback.trim()&&r.rating<=2).map(r=>r.feedback.trim()).slice(0,3),advice:a.friendAdvice.trim()||void 0,dimensions:{compensation:((s=a.ratings.find(r=>r.id==="compensation"))==null?void 0:s.rating)||0,management:((t=a.ratings.find(r=>r.id==="management"))==null?void 0:t.rating)||0,culture:((x=a.ratings.find(r=>r.id==="culture"))==null?void 0:x.rating)||0,career:((y=a.ratings.find(r=>r.id==="career"))==null?void 0:y.rating)||0,recognition:((T=a.ratings.find(r=>r.id==="recognition"))==null?void 0:T.rating)||0,environment:((A=a.ratings.find(r=>r.id==="environment"))==null?void 0:A.rating)||0,worklife:((z=a.ratings.find(r=>r.id==="worklife"))==null?void 0:z.rating)||0,cooperation:((P=a.ratings.find(r=>r.id==="cooperation"))==null?void 0:P.rating)||0,business_health:((M=a.ratings.find(r=>r.id==="business_health"))==null?void 0:M.rating)||0}};await U(k),n==null||n.success("Review submitted successfully! Thank you for sharing your experience."),setTimeout(()=>{o(`/company/${a.company.id}`)},1500)}catch(k){console.error("Submission failed:",k),n==null||n.error(k.message||"Failed to submit review. Please try again."),l(!1)}},S=()=>a.company&&a.role.trim().length>0&&a.ratings.every(s=>s.rating>0)&&a.overallRecommendation,D=["Technology","Finance","Healthcare","Education","Retail","Manufacturing","Consulting","Media","Government","Non-profit","Other"],W=["1-50 employees","51-200 employees","201-1000 employees","1000+ employees"];return m?e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"animate-pulse",children:[e.jsx("div",{className:"h-8 bg-gray-300 rounded w-1/4 mb-8"}),e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-sm mb-8",children:[e.jsx("div",{className:"h-12 bg-gray-300 rounded w-1/3 mb-4"}),e.jsx("div",{className:"h-4 bg-gray-300 rounded w-1/2"})]})]})})}):b?e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("button",{onClick:()=>c(!1),className:"flex items-center space-x-2 text-gray-600 hover:text-gray-900 transition-colors duration-200",children:[e.jsx($,{className:"w-5 h-5"}),e.jsx("span",{children:"Back to Edit"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[d&&e.jsxs("span",{className:"text-sm text-gray-500 flex items-center",children:[e.jsx(F,{className:"w-4 h-4 mr-1 animate-spin"}),"Saving..."]}),e.jsx("button",{onClick:q,disabled:!S()||h,className:"bg-gradient-to-r from-blue-600 to-green-500 text-white px-6 py-2 rounded-lg font-medium hover:shadow-lg hover:scale-105 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100 flex items-center space-x-2",children:h?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Submitting..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Z,{className:"w-4 h-4"}),e.jsx("span",{children:"Submit Review"})]})})]})]}),e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-sm border border-gray-200",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-6",children:"Review Preview"}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Company Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Company:"}),e.jsx("span",{className:"ml-2 text-gray-900",children:(E=a.company)==null?void 0:E.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Industry:"}),e.jsx("span",{className:"ml-2 text-gray-900",children:a.industry||"Not specified"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Company Size:"}),e.jsx("span",{className:"ml-2 text-gray-900",children:a.companySize||"Not specified"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Role:"}),e.jsx("span",{className:"ml-2 text-gray-900",children:a.role||"Not specified"})]})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Ratings"}),e.jsx("div",{className:"space-y-4",children:a.ratings.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-medium text-gray-900",children:s.title}),e.jsx("p",{className:"text-sm text-gray-600",children:s.description}),s.feedback&&e.jsxs("p",{className:"text-sm text-gray-700 mt-2 italic",children:['"',s.feedback,'"']})]}),e.jsx("div",{className:"ml-4",children:e.jsx(I,{rating:s.rating,onRatingChange:()=>{},disabled:!0})})]},s.id))})]}),e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Overall Recommendation"}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsxs("p",{className:"font-medium text-gray-900 mb-2",children:[a.overallRecommendation==="highly-recommend"&&"âœ… Highly Recommend",a.overallRecommendation==="maybe"&&"ðŸ¤” Maybe",a.overallRecommendation==="not-recommended"&&"âŒ Not Recommended"]}),a.friendAdvice&&e.jsxs("p",{className:"text-gray-700 italic",children:['"',a.friendAdvice,'"']})]})]})]})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("button",{onClick:()=>o("/"),className:"flex items-center space-x-2 text-gray-600 hover:text-gray-900 transition-colors duration-200",children:[e.jsx($,{className:"w-5 h-5"}),e.jsx("span",{children:"Back to Home"})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[d&&e.jsxs("span",{className:"text-sm text-gray-500 flex items-center",children:[e.jsx(F,{className:"w-4 h-4 mr-1 animate-spin"}),"Auto-saving..."]}),e.jsxs("button",{onClick:()=>c(!0),disabled:!S(),className:"flex items-center space-x-2 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ee,{className:"w-4 h-4"}),e.jsx("span",{children:"Preview"})]})]})]}),e.jsx(Q,{progress:C(),title:"Submit Your Review",subtitle:"Help others make informed career decisions with your honest feedback"}),e.jsx(R,{title:"Company Information",description:"Tell us about the company you're reviewing",required:!0,children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Company Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(se,{selectedCompany:a.company,onCompanySelect:v,placeholder:"Search for your company..."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Industry"}),e.jsxs("select",{value:a.industry,onChange:s=>f(t=>({...t,industry:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",children:[e.jsx("option",{value:"",children:"Select industry..."}),D.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Company Size"}),e.jsxs("select",{value:a.companySize,onChange:s=>f(t=>({...t,companySize:s.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",children:[e.jsx("option",{value:"",children:"Select size..."}),W.map(s=>e.jsx("option",{value:s,children:s},s))]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Your Role/Department ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",value:a.role,onChange:s=>f(t=>({...t,role:s.target.value})),placeholder:"e.g. Software Engineer, Marketing Manager",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",required:!0})]})]})}),e.jsx(R,{title:"Rate Your Experience",description:"Rate each aspect of your workplace experience on a scale of 1-5 stars",required:!0,children:e.jsx("div",{className:"space-y-8",children:a.ratings.map((s,t)=>e.jsxs("div",{className:"border-b border-gray-200 pb-6 last:border-b-0",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-1",children:s.title}),e.jsx("p",{className:"text-gray-600 text-sm",children:s.description})]}),e.jsxs("div",{className:"ml-6 flex flex-col items-end",children:[e.jsx(I,{rating:s.rating,onRatingChange:x=>w(s.id,x),size:"lg"}),e.jsx("span",{className:"text-sm text-gray-500 mt-1",children:s.rating>0?`${s.rating}/5`:"Not rated"})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(O,{value:s.feedback,onChange:x=>H(s.id,x),placeholder:`Share specific details about ${s.title.toLowerCase()}...`,maxLength:500,rows:3})})]},s.id))})}),e.jsx(R,{title:"Overall Recommendation",description:"Would you recommend this company to a friend?",required:!0,children:e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[{value:"highly-recommend",label:"Highly Recommend",emoji:"âœ…",color:"green"},{value:"maybe",label:"Maybe",emoji:"ðŸ¤”",color:"yellow"},{value:"not-recommended",label:"Not Recommended",emoji:"âŒ",color:"red"}].map(s=>e.jsxs("button",{onClick:()=>f(t=>({...t,overallRecommendation:s.value})),className:`p-4 border-2 rounded-lg transition-all duration-200 ${a.overallRecommendation===s.value?`border-${s.color}-500 bg-${s.color}-50`:"border-gray-200 hover:border-gray-300"}`,children:[e.jsx("div",{className:"text-2xl mb-2",children:s.emoji}),e.jsx("div",{className:"font-medium text-gray-900",children:s.label})]},s.value))}),e.jsx("div",{children:e.jsx(O,{value:a.friendAdvice,onChange:s=>f(t=>({...t,friendAdvice:s})),placeholder:"What would you tell a friend considering this company?",maxLength:500,rows:4,label:"Additional Advice (Optional)"})})]})}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200 text-center",children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"Your review will be published anonymously and help others make informed career decisions."}),e.jsx("button",{onClick:()=>c(!0),disabled:!S(),className:"bg-gradient-to-r from-blue-600 to-green-500 text-white px-8 py-3 rounded-lg font-medium hover:shadow-lg hover:scale-105 transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed disabled:hover:scale-100",children:"Preview & Submit Review"})]})]})})};export{le as default};
